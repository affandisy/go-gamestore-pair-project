-- Migrasi database gamestore Postgresql

-- CUSTOMERS
CREATE TABLE IF NOT EXISTS Customers (
    customerID INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    email CITEXT NOT NULL UNIQUE,
    password VARCHAR(100) NOT NULL,
    created_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),
    updated_at TIMESTAMPTZ NOT NULL DEFAULT NOW()
)

-- CATEGORIES
CREATE TABLE IF NOT EXISTS Categories (
    categoryID INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
)

-- GAMES
CREATE TABLE IF NOT EXISTS Games (
    gameID INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    categoryID INT NOT NULL REFERENCES Categories(categoryID) ON DELETE RESTRICT,
    titles VARCHAR(100) NOT NULL,
    price NUMERIC(10,2) NOT NULL CHECK (price >= 0)
    created_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),
    updated_at TIMESTAMPTZ NOT NULL DEFAULT NOW()
)

-- ORDERS
CREATE TABLE IF NOT EXISTS Orders (
    orderID INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    customerID INT NOT NULL REFERENCES Customers(customerID) ON DELETE RESTRICT,
    gameID INT NOT NULL REFERENCES Games(gameID) ON DELETE RESTRICT,
    created_at TIMESTAMPTZ NOT NULL DEFAULT NOW()
)

-- PAYMENTS
CREATE TABLE IF NOT EXISTS Payments (
    paymentID INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    orderID INT NOT NULL REFERENCES Orders(orderID) ON DELETE RESTRICT,
    amount NUMERIC(12, 2) NOT NULL CHECK,
    status VARCHAR(50) NOT NULL,
    created_at TIMESTAMPTZ NOT NULL DEFAULT NOW()
)


-- SAMPLE DATA